<!doctype html>
<html>
<head>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/jquery.mobile.css" />

    <script src="js/jquery.min.js"></script>

    <script src="js/jquery.mobile.min.js"></script>
    <script src="http://cdn.jtsage.com/jtsage-datebox/4.0.0/jtsage-datebox-4.0.0.jqm.min.js" type="text/javascript"></script>

    <link href="http://cdn.jtsage.com/jtsage-datebox/4.0.0/jtsage-datebox-4.0.0.jqm.min.css" rel="stylesheet" type="text/css">


    <script type="text/javascript">
        $.ajax({
            url: "/info",
            success: function( result ) {
                $( "#curr_speed_1" ).text("Pump 1 speed: " + result.pump_1_speed);
                $( "#curr_speed_2" ).text("Pump 2 speed: " + result.pump_2_speed);
                $( "#mode" ).val(result.mode).change();
                $( "#duration").val(result.duration);
                $("#night_start").datebox('setTheDate', new Date(0, 0, 0, result.night_start.hours, result.night_start.minutes, 0, 0));
                $("#night_end").datebox('setTheDate', new Date(0, 0, 0, result.night_end.hours, result.night_end.minutes, 0, 0));
            }
        });


        $(document).on("pagebeforeshow", "#main_page", function() {
            $("#night_start").bind('datebox', function (e, passed) {
                if (passed.method === 'set') {
                    $.post("set_night_start", {
                        hours: passed.date.getHours(),
                        minutes: passed.date.getMinutes()
                    });
                }
            });

            $("#night_end").bind('datebox', function (e, passed) {
                if (passed.method === 'set') {
                    $.post("set_night_end", {
                        hours: passed.date.getHours(),
                        minutes: passed.date.getMinutes()
                    });
                }
            });
        });
    </script>
</head>

<body>
    <div data-role="page" id="main_page">
 
        <div data-role="header">
            <h1>My Title</h1>
	    <a href="wifisetup.html" rel="external">Wifi Setup</a>
	    <a href="restartesp" rel="external">Restart</a>

        </div><!-- /header -->
 
        <div role="main" data-role="content">
            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <div id="curr_speed_1">Pump 1 speed: </div>
                </div>

                <div class="ui-block-b">
                    <div id="curr_speed_2">Pump 2 speed: </div>
                </div>
            </div>


            <form>


                        <label for="mode">Mode:</label>
                        <select name="mode" id="mode">
                            <option value="1">SINE WAVE DESYNCHRONIZED</option>
                            <option value="2">SINE WAVE SYNCHRONIZED</option>
                            <option value="3">TIDAL SWELL</option>
                            <option value="4">REEF CREST</option>
                            <option value="5">MANUAL</option>
                        </select>

                    <label for="duration">Cycle duration</label>
                    <input type="range" name="slider" id="duration" value="5000" min="1000" max="10000" />

                    <label for="pump1_man_speed">Pump 1 Manual Speed</label>
                    <input type="range" name="slider" id="pump1_man_speed" value="25" min="0" max="100" />

                    <label for="pump2_man_speed">Pump 2 Manual Speed</label>
                    <input type="range" name="slider" id="pump2_man_speed" value="25" min="0" max="100" />



                <div class="ui-field-contain">
                    <h3>Night mode</h3>
                    <label for="night_mode_enabled">Enabled</label>
                    <input type="checkbox" id="night_mode_enabled"/>
                </div>
                <div class="ui-field-contain">
                    <label for="night_start">Start time</label>
                    <input type="text" data-role="datebox" data-options='{"mode":"timebox"}' id="night_start"/>
                </div>
                <div class="ui-field-contain">
                    <label for="night_end">End time</label>
                    <input type="text" data-role="datebox" data-options='{"mode":"timebox"}' id="night_end"/>
                </div>

            </form>
        </div><!-- /content -->
 
        <div data-role="footer">
            <h4>My Footer</h4>
        </div><!-- /footer -->
 
    </div><!-- /page -->
Hi There!
</body>
</html>
